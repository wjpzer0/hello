# 题目

求解一个给定的方程，将`x`以字符串 `"x=#value"` 的形式返回。该方程仅包含 `'+'` ， `'-'` 操作，变量 `x` 和其对应系数。

如果方程没有解，请返回 `"No solution"` 。如果方程有无限解，则返回 `“Infinite solutions”` 。

题目保证，如果方程中只有一个解，则 'x' 的值是一个整数。

**示例 1：**

```
输入: equation = "x+5-3+x=6+x-2"
输出: "x=2"
```

**示例 2:**

```
输入: equation = "x=x"
输出: "Infinite solutions"
```

**示例 3:**

```
输入: equation = "2x=x"
输出: "x=0"
```

**提示:**

- `3 <= equation.length <= 1000`
- `equation` 只有一个 `'='`.
- `equation` 方程由整数组成，其绝对值在 `[0, 100]` 范围内，不含前导零和变量 `'x'` 。

## 我的解法

代码极其离谱，不够精简！对于算法字符串的处理有很大的问题，一直在打补丁！

```py
class Solution:
    def solveEquation(self, equation: str) -> str:
        def equatinoSum(equa):
            x = 0
            num = 0
            mark = 1
            mid = ""
            for s in equa:
                if s == '+':
                    if len(mid) == 0:
                        mark = 1
                        continue
                    if 'x' in mid:
                        if len(mid) == 1:
                            x += mark
                        else:
                            x += int(mid[:-1]) * mark
                    else:
                        num += int(mid) * mark
                    mark = 1
                    mid = ""
                elif s == '-':
                    if len(mid) == 0:
                        mark = -1
                        continue
                    if 'x' in mid:
                        if len(mid) == 1:
                            x += mark
                        else:
                            x += int(mid[:-1]) * mark
                    else:
                        num += int(mid) * mark
                    mark = -1
                    mid = ""
                else:
                    mid += s
            if 'x' in mid:
                if len(mid) == 1:
                    x += mark
                else:
                    x += int(mid[:-1]) * mark
            else:
                num += int(mid) * mark
            return x, num

        left, right = equation.split('=')
        lx, lnum = equatinoSum(left)
        rx, rnum = equatinoSum(right)
        newx = lx - rx
        newNum = rnum - lnum

        if newx == 0:
            if newNum == 0:
                return "Infinite solutions"
            else:
                return "No solution"
        ans = newNum // newx
        return "x=" + str(ans)
```

## 其他解法

### 解析

```c++
class Solution {
public:
    string solveEquation(string equation) {
        int factor = 0, val = 0;
        int index = 0, n = equation.size(), sign1 = 1; // 等式左边默认系数为正
        while (index < n) {
            if (equation[index] == '=') {
                sign1 = -1; // 等式右边默认系数为负
                index++;
                continue;
            }

            int sign2 = sign1, number = 0;
            bool valid = false; // 记录 number 是否有效
            if (equation[index] == '-' || equation[index] == '+') { // 去掉前面的符号
                sign2 = (equation[index] == '-') ? -sign1 : sign1;
                index++;
            }
            while (index < n && isdigit(equation[index])) {
                number = number * 10 + (equation[index] - '0');
                index++;
                valid = true;
            }

            if (index < n && equation[index] == 'x') { // 变量
                factor += valid ? sign2 * number : sign2;
                index++;
            } else { // 数值
                val += sign2 * number;
            }
        }

        if (factor == 0) {
            return val == 0 ? "Infinite solutions" : "No solution";
        }
        return string("x=") + to_string(-val / factor);
    }
};
```

```java
class Solution {
    public String solveEquation(String equation) {
        int factor = 0, val = 0;
        int index = 0, n = equation.length(), sign1 = 1; // 等式左边默认系数为正
        while (index < n) {
            if (equation.charAt(index) == '=') {
                sign1 = -1; // 等式右边默认系数为负
                index++;
                continue;
            }

            int sign2 = sign1, number = 0;
            boolean valid = false; // 记录 number 是否有效
            if (equation.charAt(index) == '-' || equation.charAt(index) == '+') { // 去掉前面的符号
                sign2 = (equation.charAt(index) == '-') ? -sign1 : sign1;
                index++;
            }
            while (index < n && Character.isDigit(equation.charAt(index))) {
                number = number * 10 + (equation.charAt(index) - '0');
                index++;
                valid = true;
            }

            if (index < n && equation.charAt(index) == 'x') { // 变量
                factor += valid ? sign2 * number : sign2;
                index++;
            } else { // 数值
                val += sign2 * number;
            }
        }

        if (factor == 0) {
            return val == 0 ? "Infinite solutions" : "No solution";
        }
        return "x=" + (-val / factor);
    }
}
```

```python
class Solution:
    def solveEquation(self, equation: str) -> str:
        factor = val = 0
        i, n, sign = 0, len(equation), 1  # 等式左边默认系数为正
        while i < n:
            if equation[i] == '=':
                sign = -1
                i += 1
                continue

            s = sign
            if equation[i] == '+':  # 去掉前面的符号
                i += 1
            elif equation[i] == '-':
                s = -s
                i += 1

            num, valid = 0, False
            while i < n and equation[i].isdigit():
                valid = True
                num = num * 10 + int(equation[i])
                i += 1

            if i < n and equation[i] == 'x':  # 变量
                factor += s * num if valid else s
                i += 1
            else:  # 数值
                val += s * num

        if factor == 0:
            return "No solution" if val else "Infinite solutions"
        return f"x={-val // factor}"
```

我们将等式右边的项都移到等式左边，那么等式右边的项的默认系数为 -1。我们依次解析方程的项，并将同类项进行合并，使用 $\textit{factor}$表示变量的系数，$\textit{val}$表示常量值。

初始时默认系数$ \textit{sign}_1 = 1$，当我们解析到等号时，说明解析到等式右边的项，令 $\textit{sign}_1 = -1$。使用变量 $\textit{sign}_2$ 表示项的符号，初始时 $\textit{sign}_2 = \textit{sign}_1$，如果我们解析到 $\text{‘+’}$ 或 $\text{‘-’}$，那么相应的更改 $\textit{sign}_2$。使用 $\textit{number}$记录数字，$\textit{valid}$表示 $\textit{number}$是否有效（变量 x 前面可能没有数字），如果我们解析到的项是变量项，那么相应的更改 $\textit{factor}$；如果我们解析到的项是常量项，那么相应的更改 $\textit{val}$。

如果 $\textit{factor} = 0 $成立，说明变量 x 对方程无影响，然后判断 $\textit{val} = 0$ 是否成立，成立则说明方程有无数解，返回$ \text{“Infinite solutions”}$，否则返回 $\text{“No solution”}$。其他情况直接返回对应的整数解 $x = \dfrac{-\textit{val}}{\textit{factor}}$。

#### 复杂度分析

时间复杂度：O(n)，其中 nn 是字符串 $\textit{equation}$的长度。

空间复杂度：O(1)。

